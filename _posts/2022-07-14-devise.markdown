---
layout: post
title: "devise的使用"
date: "2022-07-14"
categories: 
---
<p>1.在rails console进行创建用户</p>

<p>$bundle exec rials c</p>

{% highlight %}a = Account.new
a.password = &#39;22222222&#39;

a.email = &#39;hi@email&#39;
a.save!{% endhighlight %}

<p>如果email重复了，重新输入a.email = &#39;hi@hihi&#39;即可，然后直接a.save!<br />
2.设置该用户的密码 password=</p>

<p>password= 是一个方法，进行更新用户的密码</p>

<p>devise是不能进行email的更改的</p>

{% highlight %}
{% highlight %}a= Account.find(1)

a.password = &#39;22222211&#39;

a.save!{% endhighlight %}

<p><br />
3.验证密码的方法，.valid_password</p>

<p>&nbsp;</p>

{% highlight %}
{% highlight %}Account.find(26).valid_password?(&#39;33333333&#39;)

&nbsp; Account Load (0.2ms)&nbsp; SELECT &quot;accounts&quot;.* FROM &quot;accounts&quot; WHERE &quot;accounts&quot;.&quot;id&quot; = $1 LIMIT $2&nbsp; [[&quot;id&quot;, 26], [&quot;LIMIT&quot;, 1]]

=&gt; true{% endhighlight %}

<p>https://www.rubydoc.info/github/plataformatec/devise/Devise/Models/DatabaseAuthenticatable</p>

<pre class="default s-code-block">
<code class="hljs language-shell"><span class="hljs-meta prompt_">&gt; </span><span class="language-bash">me = User.find(10)</span>
<span class="hljs-meta prompt_">&gt; </span><span class="language-bash">me.password = <span class="hljs-string">&#39;123456789&#39;</span></span>
<span class="hljs-meta prompt_">&gt; </span><span class="language-bash">me.password_confirmation = <span class="hljs-string">&#39;123456789&#39;</span></span>
<span class="hljs-meta prompt_">&gt; </span><span class="language-bash">me.save</span>
{% endhighlight %}

<pre class="default s-code-block">
<code class="hljs language-ruby">user = User.find_by_email(params[<span class="hljs-symbol">:user</span>][<span class="hljs-symbol">:email</span>])
user.valid_password?(params[<span class="hljs-symbol">:user</span>][<span class="hljs-symbol">:password</span>]){% endhighlight %}

<p>{% highlight %}参考：{% endhighlight %}<a href="https://stackoverflow.com/questions/4320921/how-to-verify-a-users-password-in-devise">https://stackoverflow.com/questions/4320921/how-to-verify-a-users-password-in-devise</a></p>

<p>4.在action进行使用上面的三步</p>

{% highlight %}
{% highlight %}Account.create email: params[:email], mobile: params[:mobile], password: params[:account][:password]{% endhighlight %}

